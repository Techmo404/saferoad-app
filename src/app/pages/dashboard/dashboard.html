<div class="dashboard">

  <!-- barra superior -->
  <header class="app-header">
    <div class="brand">
      <span>SafeRoad AI</span>
    </div>

    <button class="logout" (click)="logout()">Cerrar sesión</button>
  </header>

  <div class="content container-fluid mt-4">

    <div class="row justify-content-center">

      
      <div class="col-lg-3 col-md-5">

        <div class="card shadow-lg p-4 control-panel">

          <h5 class="fw-bold text-primary mb-3">Centro de Control</h5>

          <button class="btn btn-primary w-100 mb-3" (click)="getRisk()">
             Analizar Zona Actual
          </button>

        </div>

        <!-- resultado-->
        <div *ngIf="riskResult" class="result-panel card p-4 shadow-lg mt-4">

          <h4 class="fw-bold text-primary mb-3">
             Resultado del Análisis
          </h4>

          <div class="risk-status-box mb-3"
            [ngClass]="{
              'low': riskResult.predicted_risk === 'Bajo',
              'medium': riskResult.predicted_risk === 'Medio',
              'high': riskResult.predicted_risk === 'Alto' || riskResult.predicted_risk === 'Crítico'
            }">
            {{ riskResult.predicted_risk }}
          </div>

          <hr>

          <div class="row text-start">
            <div class="col-6">
              <h6 class="fw-bold"> Ubicación</h6>
              Lat: {{ riskResult.coords.lat }} <br>
              Lng: {{ riskResult.coords.lng }}
            </div>

            <div class="col-6">
              <h6 class="fw-bold"> Fecha</h6>
              {{ riskResult.datetime }}
            </div>
          </div>

          <hr>

          <div class="row mt-2">
            <div class="col-6">
              <h6 class="fw-bold"> Clima</h6>
              {{ riskResult.weather.weather[0]?.description }} <br>
              Temp: {{ riskResult.weather.main.temp }}°C <br>
              Viento: {{ riskResult.weather.wind.speed }} km/h
            </div>

            <div class="col-6">
              <h6 class="fw-bold"> Tráfico</h6>
              Velocidad: {{ riskResult.traffic.speed }} km/h <br>
              Congestión: {{ riskResult.traffic.jam_factor }} <br>
              Estado: {{ riskResult.traffic.status }}
            </div>
          </div>

          <hr>

          <p class="mt-3 text-muted small">
             Modelo usado: <strong>{{ riskResult.model }}</strong>
          </p>

        </div>

      </div>


      <div class="col-lg-7 col-md-7">
        <div class="card shadow-lg overflow-hidden">
          <div id="map" class="map"></div>
        </div>
      </div>

    </div>
  </div>
</div>
